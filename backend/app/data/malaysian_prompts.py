"""
Malaysian Business Smart Prompts for Stability AI
Maps local terms to detailed English prompts for accurate image generation
"""

# ============================================
# MALAYSIAN FOOD PROMPTS FOR STABILITY AI
# ============================================
MALAYSIAN_FOOD_PROMPTS = {
    # Rice Dishes
    "nasi kandar": "Malaysian nasi kandar plate with fluffy white rice, yellow curry chicken, fried chicken, vegetables, and variety of colorful curries, banana leaf, authentic mamak restaurant style, food photography, professional lighting",
    "nasi lemak": "Malaysian nasi lemak with fragrant coconut rice, sambal, fried anchovies ikan bilis, peanuts, cucumber slices, hard boiled egg, wrapped in banana leaf, food photography",
    "nasi goreng": "Malaysian nasi goreng fried rice with prawns, egg, vegetables, spicy red color, served on white plate, food photography",
    "nasi goreng kampung": "Village style nasi goreng kampung with anchovies, long beans, bird eye chili, egg, traditional Malaysian fried rice, food photography",
    "nasi goreng usa": "Malaysian nasi goreng USA with sunny side up egg, chicken, sausage, vegetables, special fried rice, food photography",
    "nasi goreng pattaya": "Nasi goreng pattaya wrapped in thin egg omelette, ketchup on top, Malaysian style, food photography",
    "nasi ayam": "Malaysian chicken rice nasi ayam with steamed chicken, rice cooked in chicken broth, chili sauce, cucumber, food photography",
    "nasi biryani": "Aromatic biryani rice with saffron, spices, tender meat, fried shallots, papadam, raita, food photography",

    # Noodles
    "mee goreng": "Malaysian mee goreng mamak style, thick yellow noodles, egg, potato, tofu puff, bean sprouts, red spicy sauce, lime wedge, food photography",
    "mee goreng mamak": "Authentic mamak mee goreng with thick yellow noodles, egg, potato cubes, tofu puff, bean sprouts, spicy red sauce, food photography",
    "char kuey teow": "Penang char kuey teow, flat rice noodles wok fried with prawns, cockles, egg, bean sprouts, chives, smoky wok hei, food photography",
    "char kway teow": "Penang style char kway teow, flat rice noodles with prawns, cockles, egg, chives, bean sprouts, dark soy sauce, food photography",
    "mee rebus": "Malaysian mee rebus, yellow noodles in thick spicy gravy, hard boiled egg, tofu, green chili, lime, fried shallots, food photography",
    "mee hoon goreng": "Fried vermicelli mee hoon goreng with vegetables, egg, soy sauce, Malaysian style, food photography",
    "laksa": "Malaysian curry laksa, thick rice noodles in spicy coconut curry soup, tofu puff, prawns, cockles, bean sprouts, food photography",
    "laksa penang": "Penang assam laksa, rice noodles in tangy fish soup, cucumber, pineapple, onion, torch ginger flower, shrimp paste, food photography",
    "wantan mee": "Malaysian wonton noodles with char siu BBQ pork, wontons, choy sum, dark sauce, food photography",
    "pan mee": "Malaysian pan mee handmade noodles in anchovy broth, minced pork, ikan bilis, poached egg, leafy greens, food photography",

    # Chicken
    "ayam goreng": "Malaysian ayam goreng berempah, crispy fried chicken with golden turmeric coating, served on banana leaf, food photography",
    "ayam goreng berempah": "Crispy Malaysian spiced fried chicken, golden brown turmeric and lemongrass coating, food photography",
    "ayam rendang": "Malaysian dry rendang ayam, tender chicken in rich caramelized coconut curry, aromatic spices, food photography",
    "ayam masak merah": "Malaysian ayam masak merah, chicken in spicy red tomato chili sauce, garnished with fried shallots, food photography",
    "ayam percik": "Grilled ayam percik with spicy coconut sauce, charred marks, Kelantan style, food photography",
    "ayam penyet": "Smashed fried chicken ayam penyet with spicy sambal, fresh vegetables lalapan, food photography",
    "satay ayam": "Malaysian chicken satay skewers, grilled on charcoal, served with peanut sauce, ketupat rice cake, cucumber, onion, food photography",

    # Meat
    "rendang": "Malaysian beef rendang, slow-cooked dry curry with tender meat, toasted coconut, caramelized spices, food photography",
    "rendang daging": "Traditional beef rendang, dark rich coconut curry, tender meat chunks, aromatic, food photography",
    "satay": "Malaysian satay skewers on charcoal grill, peanut sauce, rice cake, cucumber, onion, food photography",
    "sup kambing": "Malaysian mutton soup sup kambing, rich broth with spices, tender meat, celery, fried shallots, food photography",

    # Seafood
    "ikan bakar": "Malaysian ikan bakar grilled fish with sambal sauce, wrapped in banana leaf, charred, food photography",
    "ikan goreng": "Crispy fried whole fish ikan goreng, golden brown, served with sambal, food photography",
    "sambal udang": "Spicy sambal prawns Malaysian style, red chili paste, onions, food photography",
    "sotong goreng": "Crispy fried squid sotong goreng, golden batter, served with chili sauce, food photography",
    "kepah": "Stir fried clams kepah with chili garlic sauce, Malaysian style, food photography",
    "ketam": "Malaysian chili crab or butter crab, whole crab in rich sauce, food photography",

    # Roti & Bread
    "roti canai": "Malaysian roti canai flatbread, flaky layered, served with dhal curry and sambal, food photography",
    "roti telur": "Roti telur egg flatbread, crispy outside, egg inside, served with curry, food photography",
    "roti bom": "Thick round roti bom with condensed milk, Malaysian flatbread, food photography",
    "roti tisu": "Paper thin crispy roti tissue, cone shaped, drizzled with condensed milk, food photography",
    "naan": "Fluffy naan bread, charred spots from tandoor, served with curry, food photography",
    "capati": "Indian chapati flatbread, whole wheat, served with curry, food photography",

    # Drinks
    "teh tarik": "Malaysian teh tarik being pulled, stretched milk tea, frothy, in glass mug, food photography",
    "kopi": "Malaysian kopi coffee in traditional kopitiam cup, dark roasted, condensed milk, food photography",
    "milo": "Iced milo chocolate malt drink, Malaysian style, topped with Milo powder, food photography",
    "sirap bandung": "Pink rose syrup sirap bandung drink with milk, refreshing Malaysian drink, food photography",
    "air kelapa": "Fresh coconut water in young coconut shell, tropical, food photography",
    "cendol": "Malaysian cendol shaved ice dessert, green rice jelly, coconut milk, gula melaka palm sugar, red beans, food photography",
    "ais kacang": "Colorful ABC shaved ice ais kacang, red syrup, corn, beans, jelly, condensed milk, food photography",

    # Kuih & Desserts
    "kuih": "Colorful Malaysian kuih traditional cakes assortment, nyonya kuih, layer cakes, food photography",
    "kuih lapis": "Layered steamed kuih lapis, colorful layers, Malaysian dessert, food photography",
    "ondeh ondeh": "Green pandan balls ondeh ondeh with palm sugar filling, coated in coconut, food photography",
    "kuih seri muka": "Two layer kuih seri muka, pandan custard on glutinous rice, food photography",
    "apam balik": "Fluffy peanut pancake apam balik, crispy edges, peanuts, corn, butter, sugar, food photography",
    "pisang goreng": "Crispy fried banana fritters pisang goreng, golden brown, food photography",
    "curry puff": "Golden curry puff karipap, flaky pastry, potato chicken filling, food photography",

    # Vegetables & Side Dishes
    "kangkung": "Stir fried kangkung water spinach with belacan, garlic, chili, food photography",
    "sayur campur": "Mixed vegetables stir fry, colorful, Malaysian style, food photography",
    "taugeh": "Bean sprouts stir fry with garlic, simple vegetable dish, food photography",
    "pucuk paku": "Jungle fern pucuk paku stir fry with belacan, Malaysian wild vegetable, food photography",
    "pelbagai lauk": "Malaysian nasi kandar side dishes spread, various curries and vegetables in metal trays, colorful, food photography",
    "lauk": "Malaysian curry dishes assortment, chicken curry, fish curry, vegetables, food photography",
}

# ============================================
# MALAYSIAN FASHION PROMPTS
# ============================================
MALAYSIAN_FASHION_PROMPTS = {
    "baju kurung": "Elegant Malaysian baju kurung traditional dress, flowing fabric, embroidered, worn by Malay woman, fashion photography",
    "baju kurung moden": "Modern baju kurung with contemporary cut, stylish design, Malaysian fashion, fashion photography",
    "baju melayu": "Traditional baju melayu for men with songkok cap, sampin, Hari Raya attire, fashion photography",
    "kebaya": "Elegant kebaya lace blouse with sarong, nyonya peranakan style, fashion photography",
    "kebaya nyonya": "Traditional nyonya kebaya with intricate embroidery, paired with batik sarong, fashion photography",
    "tudung": "Elegant hijab tudung headscarf, various styles, Malaysian Muslim fashion, fashion photography",
    "tudung bawal": "Square tudung bawal hijab, draped elegantly, Malaysian style, fashion photography",
    "shawl": "Flowing shawl hijab style, elegant draping, Malaysian fashion, fashion photography",
    "songket": "Traditional songket brocade fabric with gold thread, royal Malay textile, product photography",
    "batik": "Malaysian batik fabric with traditional patterns, colorful design, product photography",
    "sampin": "Traditional sampin waist cloth for men, worn with baju melayu, Malay attire, fashion photography",
}

# ============================================
# MALAYSIAN SERVICES PROMPTS
# ============================================
MALAYSIAN_SERVICES_PROMPTS = {
    # Salon & Beauty
    "salon": "Modern Malaysian hair salon interior, styling chairs, mirrors, professional equipment, interior photography",
    "barber": "Traditional barber shop with barber chair, mirrors, grooming tools, interior photography",
    "hair cut": "Professional hairstylist cutting hair, salon setting, service photography",
    "hair coloring": "Hair coloring process, foils, dye application, salon photography",
    "facial": "Relaxing facial treatment, spa setting, skincare service, beauty photography",
    "spa": "Luxury spa interior with massage beds, candles, zen atmosphere, interior photography",
    "manicure": "Nail manicure service, nail polish application, beauty photography",
    "pedicure": "Relaxing pedicure treatment, foot spa, nail care, beauty photography",
    "makeup": "Professional makeup application, bridal or event makeup, beauty photography",
    "bridal makeup": "Malaysian bridal makeup, elegant bride, traditional or modern style, beauty photography",

    # Automotive
    "car wash": "Car being washed, foam, water spray, car wash service, photography",
    "bengkel": "Malaysian car workshop bengkel, mechanic working on car, automotive service, photography",
    "tyre shop": "Tire shop with stacks of new tyres, wheel alignment service, automotive photography",
    "car service": "Car maintenance service, mechanic checking engine, automotive workshop, photography",

    # Food Service
    "catering": "Malaysian catering setup, buffet spread with local dishes, event catering, food photography",
    "warung": "Traditional Malaysian warung food stall, humble eatery, local atmosphere, photography",
    "mamak": "Busy mamak restaurant at night, 24 hour eatery, Malaysian street food culture, photography",
    "kopitiam": "Traditional kopitiam coffee shop, marble tables, wooden chairs, nostalgic Malaysian cafe, interior photography",

    # Professional Services
    "tuition": "Tutoring class, students learning, Malaysian education, photography",
    "gym": "Modern gym interior, exercise equipment, fitness center, interior photography",
    "laundry": "Laundry service, clean clothes, washing machines, service photography",
}

# ============================================
# GENERIC BUSINESS PROMPTS
# ============================================
GENERIC_BUSINESS_PROMPTS = {
    "restaurant": "Elegant restaurant interior, warm lighting, dining tables, Malaysian ambiance, interior photography",
    "cafe": "Cozy cafe interior, coffee bar, comfortable seating, natural light, interior photography",
    "shop": "Modern retail shop interior, product displays, clean design, interior photography",
    "office": "Professional office interior, modern workspace, clean design, interior photography",
    "clinic": "Clean medical clinic interior, waiting area, professional healthcare setting, interior photography",
    "hotel": "Luxury hotel lobby, elegant interior, Malaysian hospitality, interior photography",
}

# ============================================
# SMART PROMPT GENERATOR
# ============================================
def get_smart_stability_prompt(item_name: str, business_type: str = "") -> str:
    """
    Generate accurate Stability AI prompt for Malaysian items.
    Searches through all dictionaries to find best match.

    Args:
        item_name: Name of menu item, product, or service
        business_type: Type of business (restaurant, salon, etc.)

    Returns:
        Detailed English prompt for Stability AI
    """
    item_lower = item_name.lower().strip()
    business_lower = business_type.lower().strip() if business_type else ""

    # 1. Direct match in food prompts
    if item_lower in MALAYSIAN_FOOD_PROMPTS:
        return MALAYSIAN_FOOD_PROMPTS[item_lower]

    # 2. Direct match in fashion prompts
    if item_lower in MALAYSIAN_FASHION_PROMPTS:
        return MALAYSIAN_FASHION_PROMPTS[item_lower]

    # 3. Direct match in services prompts
    if item_lower in MALAYSIAN_SERVICES_PROMPTS:
        return MALAYSIAN_SERVICES_PROMPTS[item_lower]

    # 4. Partial match - check if item contains any key
    all_prompts = {
        **MALAYSIAN_FOOD_PROMPTS,
        **MALAYSIAN_FASHION_PROMPTS,
        **MALAYSIAN_SERVICES_PROMPTS,
        **GENERIC_BUSINESS_PROMPTS
    }

    for key, prompt in all_prompts.items():
        if key in item_lower or item_lower in key:
            return prompt

    # 5. Keyword matching
    if any(word in item_lower for word in ["nasi", "rice"]):
        return MALAYSIAN_FOOD_PROMPTS.get("nasi goreng", f"Malaysian {item_name}, food photography, professional lighting")

    if any(word in item_lower for word in ["mee", "noodle", "mie"]):
        return MALAYSIAN_FOOD_PROMPTS.get("mee goreng", f"Malaysian noodles {item_name}, food photography")

    if any(word in item_lower for word in ["ayam", "chicken"]):
        return MALAYSIAN_FOOD_PROMPTS.get("ayam goreng", f"Malaysian chicken dish {item_name}, food photography")

    if any(word in item_lower for word in ["ikan", "fish", "seafood"]):
        return MALAYSIAN_FOOD_PROMPTS.get("ikan bakar", f"Malaysian seafood {item_name}, food photography")

    if any(word in item_lower for word in ["roti", "bread"]):
        return MALAYSIAN_FOOD_PROMPTS.get("roti canai", f"Malaysian bread {item_name}, food photography")

    if any(word in item_lower for word in ["rendang", "curry", "kari"]):
        return MALAYSIAN_FOOD_PROMPTS.get("rendang", f"Malaysian curry dish {item_name}, food photography")

    if any(word in item_lower for word in ["satay", "sate"]):
        return MALAYSIAN_FOOD_PROMPTS.get("satay", f"Malaysian satay {item_name}, food photography")

    if any(word in item_lower for word in ["kuih", "cake", "dessert"]):
        return MALAYSIAN_FOOD_PROMPTS.get("kuih", f"Malaysian dessert {item_name}, food photography")

    if any(word in item_lower for word in ["teh", "kopi", "tea", "coffee", "milo"]):
        return MALAYSIAN_FOOD_PROMPTS.get("teh tarik", f"Malaysian drink {item_name}, food photography")

    if any(word in item_lower for word in ["baju", "kurung", "kebaya"]):
        return MALAYSIAN_FASHION_PROMPTS.get("baju kurung", f"Malaysian traditional attire {item_name}, fashion photography")

    if any(word in item_lower for word in ["tudung", "hijab", "shawl"]):
        return MALAYSIAN_FASHION_PROMPTS.get("tudung", f"Malaysian hijab {item_name}, fashion photography")

    # 6. Business type fallback
    if business_lower in GENERIC_BUSINESS_PROMPTS:
        return GENERIC_BUSINESS_PROMPTS[business_lower]

    if "restaurant" in business_lower or "food" in business_lower:
        return f"Delicious {item_name}, Malaysian cuisine, food photography, professional lighting"

    if "fashion" in business_lower or "boutique" in business_lower:
        return f"Elegant {item_name}, Malaysian fashion, professional photography"

    if "salon" in business_lower or "beauty" in business_lower:
        return f"Professional {item_name} service, salon setting, beauty photography"

    # 7. Generic fallback with enhancement
    return f"Professional photograph of {item_name}, high quality, commercial photography, clean background"


def get_hero_prompt(business_name: str, business_type: str, description: str = "") -> str:
    """
    Generate hero image prompt for business website.
    """
    business_lower = business_type.lower()

    if "restaurant" in business_lower or "food" in business_lower or "nasi" in business_lower:
        return f"Beautiful Malaysian restaurant exterior or interior, warm lighting, {business_name} signage concept, welcoming atmosphere, professional photography"

    if "salon" in business_lower or "beauty" in business_lower:
        return f"Elegant beauty salon interior, modern design, mirrors, styling stations, professional atmosphere, interior photography"

    if "fashion" in business_lower or "boutique" in business_lower:
        return f"Stylish Malaysian fashion boutique interior, clothing displays, elegant design, retail photography"

    if "cafe" in business_lower or "coffee" in business_lower:
        return f"Cozy Malaysian cafe interior, coffee bar, comfortable seating, warm lighting, interior photography"

    return f"Professional business establishment, {business_type}, modern design, welcoming atmosphere, commercial photography"


def get_fallback_image(item_name: str) -> str:
    """
    Get fallback stock image URL when AI generation fails.
    """
    item_lower = item_name.lower()

    FALLBACK_IMAGES = {
        "nasi": "https://images.unsplash.com/photo-1563379091339-03b21ab4a4f8?w=600&q=80",
        "mee": "https://images.unsplash.com/photo-1617093727343-374698b1b08d?w=600&q=80",
        "ayam": "https://images.unsplash.com/photo-1626645738196-c2a7c87a8f58?w=600&q=80",
        "chicken": "https://images.unsplash.com/photo-1626645738196-c2a7c87a8f58?w=600&q=80",
        "ikan": "https://images.unsplash.com/photo-1580476262798-bddd9f4b7369?w=600&q=80",
        "fish": "https://images.unsplash.com/photo-1580476262798-bddd9f4b7369?w=600&q=80",
        "seafood": "https://images.unsplash.com/photo-1580476262798-bddd9f4b7369?w=600&q=80",
        "roti": "https://images.unsplash.com/photo-1589301760014-d929f3979dbc?w=600&q=80",
        "satay": "https://images.unsplash.com/photo-1529563021893-cc83c992d75d?w=600&q=80",
        "rendang": "https://images.unsplash.com/photo-1574484284002-952d92456975?w=600&q=80",
        "teh": "https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=600&q=80",
        "kopi": "https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=600&q=80",
        "kuih": "https://images.unsplash.com/photo-1558961363-fa8fdf82db35?w=600&q=80",
        "default": "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=600&q=80"
    }

    for key, url in FALLBACK_IMAGES.items():
        if key in item_lower:
            return url

    return FALLBACK_IMAGES["default"]
